`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>Network - Javascript Tests</title>
    <link rel="stylesheet" href="qunit-2.16.0.css">
    <script>
        var csrftoken = '{{ csrf_token }}'
    </script>
</head>
<body>
    <div id="qunit"></div>
    <div id="qunit-fixture">
        <div class="post_media" data-post-id="1">
<!--            <input type="hidden" id="post_id" value="1">-->
            <div id="content">A new post</div>
            <textarea id="content_textarea" hidden>A new post</textarea>
            <button id="edit">Edit</button>
            <button id="save" hidden>Save</button>
            <div id="likes">Likes: <span id="likes_count">1</span></div>
            <input id="user_likes_post" type="hidden" value="false">
            <button id="like" hidden>Like</button>
            <button id="unlike" hidden>Unlike</button>
        </div>

        <div class="post_media" data-post-id="2">
<!--            <input type="hidden" id="post_id" value="2">-->
            <div id="content">A second post</div>
            <textarea id="content_textarea" hidden>A second post</textarea>
            <button id="edit">Edit</button>
            <button id="save" hidden>Save</button>
            <div id="likes">Likes: <span id="likes_count">3</span></div>
            <input id="user_likes_post" type="hidden" value="true">
            <button id="like" hidden>Like</button>
            <button id="unlike" hidden>Unlike</button>
        </div>

        <div class="profile_details">
            <div id="profile">Username: <span id="profile_name">harry</span></div>
            <div id="followers">Followers: <span id="followers_count">1</span></div>
            <div id="following">Following: <span id="following_count">0</span></div>
            <button id="follow" hidden>Follow</button>
            <button id="unfollow" hidden>Unfollow</button>
            <input id="user_follows_profile" type="hidden" value="false">
        </div>
    </div>

    <script src = "https://code.jquery.com/jquery.js"></script>
    <script src="../network.js"></script>
    <script src="qunit-2.16.0.js"></script>

    <script>

        let { test } = QUnit

        QUnit.module("Edit and Save Buttons", hooks => {

            hooks.beforeEach( () => {
                window.Network.initialize()
                this.post1 = $(".post_media").first();
                this.edit_button = post1.find('#edit');
                this.save_button = post1.find('#save');
                this.content = post1.find('#content');
                this.content_textarea = post1.find('#content_textarea');
            });

            test("Sanity check test that save & textarea not initially visible", assert => {
                assert.equal(this.content_textarea.is(':visible'), false);
                assert.equal(this.save_button.is(':visible'), false);
                assert.equal(this.content.is(':visible'), true);
                assert.equal(this.edit_button.is(':visible'), true);
            });

            test("div not visible after clicking edit", (assert) => {
                this.edit_button.trigger('click');
                assert.equal(this.content.is(':visible'), false);
            });

            test("textarea visible after clicking edit", (assert) => {
                this.edit_button.trigger('click');
                assert.equal(this.content_textarea.is(':visible'), true);
            });

            test("div text the same as textarea text after clicking edit", (assert) => {
                let content_text = this.content.text();
                this.edit_button.trigger('click');

                let textarea_text = this.content_textarea.text();

                assert.equal(textarea_text, content_text);
            });

            test('Edit button not visible after clicking edit', (assert) => {
                this.edit_button.trigger('click');
                assert.equal(this.edit_button.is(':visible'), false);
            });

            test('Save button visible after clicking edit', (assert) => {
                this.edit_button.trigger('click');
                assert.equal(this.save_button.is(':visible'), true);
            });

            test("div visible after clicking save", (assert) => {
                this.edit_button.trigger('click');
                this.save_button.trigger('click');
                assert.equal(this.content.is(':visible'), true);
             });

            test("textarea not visible after clicking save", (assert) => {
                this.edit_button.trigger('click');
                this.save_button.trigger('click');
                assert.equal(this.content_textarea.is(':visible'), false);
            });

            test("div text the same as textarea text after clicking save", (assert) => {
                this.edit_button.trigger('click');

                this.content_textarea.text('A changed post');

                this.save_button.trigger('click');

                assert.equal(this.content_textarea.text(), this.content.text());
                assert.equal(this.content.text(), "A changed post");
            });

            test('Edit button visible after clicking save', (assert) => {
                this.edit_button.trigger('click');
                this.save_button.trigger('click');
                assert.equal(this.edit_button.is(':visible'), true);
            });

            test('Save button not visible after clicking save', (assert) => {
                this.edit_button.trigger('click');
                this.save_button.trigger('click');
                assert.equal(this.save_button.is(':visible'), false);
            });

            test('Edit button works on second post', (assert) => {
                let post = $('[data-post-id="2"]')

                let post_content = post.find('#content');

                let edit_button = post.find('#edit');
                let text_area = post.find('#content_textarea');

                assert.equal(text_area.is(':visible'), false);
                assert.equal(post_content.is(':visible'), true);

                edit_button.click()
                assert.equal(post_content.is(':visible'), false);
                assert.equal(text_area.is(':visible'), true);
            });

        });

        QUnit.module("Like and Unlike Buttons", hooks => {

            hooks.beforeEach(() => {
                window.Network.initialize()
                this.post1 = $(".post_media").first();
                this.like_button = post1.find('#like');
                this.unlike_button = post1.find('#unlike');
                this.user_likes_post = post1.find('#user_likes_post');
                this.likes_count = post1.find('#likes_count');
            });

            test('Sanity check initial likes value, like and unlike button', (assert) => {
                assert.equal(this.user_likes_post.val(), 'false');
                assert.equal(this.likes_count.text(), "1");
                assert.equal(this.like_button.is(':visible'), true);
                assert.equal(this.unlike_button.is(':visible'), false);
            });

            test('likes_count increments after clicking like button', (assert) => {
                this.like_button.trigger('click');
                assert.equal(this.likes_count.text(), "2");
            });

            test('Unlike button visible after clicking like button', (assert) => {
                this.like_button.trigger('click');
                assert.equal(this.unlike_button.is(':visible'), true);
            });

            test('Like button not visible after clicking like button', (assert) => {
                this.like_button.trigger('click');
                assert.equal(this.like_button.is(':visible'), false);
            });

            test('likes_count decrements after clicking unlike button', (assert) => {
                this.like_button.hide();
                this.like_button.show();

                this.unlike_button.trigger('click');
                assert.equal(this.likes_count.text(), "0")
            });

            test('Like button visible after clicking unlike button', (assert) => {
                this.like_button.hide();
                this.unlike_button.show();

                this.unlike_button.trigger('click');
                assert.equal(this.like_button.is(':visible'), true);
            });

            test('Unlike button not visible after clicking unlike button', (assert) => {
                this.like_button.hide();
                this.like_button.show();

                this.like_button.trigger('click');
                assert.equal(this.like_button.is(':visible'), false);
            });

            test('user_likes_post is true and unlike_button visible', (assert) => {
                this.user_likes_post.val('true');
                window.Network.initialize();

                assert.equal(this.unlike_button.is(':visible'), true);
            });

            test('user_likes_post is true and like_button not visible', (assert) => {
                this.user_likes_post.val('true');
                window.Network.initialize();

                assert.equal(this.like_button.is(':visible'), false);
            });

            test('user_likes_post is false and unlike_button not visible', (assert) => {
                this.user_likes_post.val('false');
                window.Network.initialize();

                assert.equal(this.unlike_button.is(':visible'), false);
            });

            test('user_likes_post is false and like_button visible', (assert) => {
                this.user_likes_post.val('false');
                window.Network.initialize();

                assert.equal(this.like_button.is(':visible'), true);
            });

            test('user_likes_post true after clicking like button', assert => {
                this.user_likes_post.val('false')
                this.like_button.trigger('click');
                assert.equal(this.user_likes_post.val(), 'true')
            });

            test('user_likes_post false after clicking unlike button', assert => {
                this.user_likes_post.val('true')
                this.unlike_button.trigger('click');
                assert.equal(this.user_likes_post.val(), 'false')
            });

        });

        QUnit.module("Follow and Unfollow Buttons", hooks => {

            test('Sanity check initial followers value, follow and unfollow button', (assert) => {
                window.Network.initialize()
                assert.equal($("#profile_name").text(), 'harry');
                assert.equal($('#user_follows_profile').val(), 'false')
                assert.equal($('#followers_count').text(), "1", "Followers_count is 1");
                assert.equal($('#follow').is(':visible'), true, "follow button is visible");
                assert.equal($('#unfollow').is(':visible'), false);
            });

            test('followers_count increments after clicking follow button', assert => {
                window.Network.initialize()
                assert.equal($('#followers_count').text(), '1');
                $('#follow').trigger('click');
                assert.equal($('#followers_count').text(), '2');
            })

            test('Follow button not visible after clicking follow', assert => {
                window.Network.initialize()
                let follow_button = $('#follow');
                $('#follow').trigger('click');
                assert.equal(follow_button.is(":visible"), false);
            })

            test('Unfollow button visible after clicking follow', assert => {
                window.Network.initialize()

                $('#follow').trigger('click');
                assert.equal($('#unfollow').is(":visible"), true);
            })

            test('followers_count decrements after clicking unfollow button', assert => {
                window.Network.initialize()
                let followers_count = $('#followers_count')
                $('#unfollow').trigger('click');
                assert.equal(followers_count.text(), '0');
            })

            test('Follow button visible after clicking unfollow', assert => {
                $('#user_follows_profile').text('true')
                window.Network.initialize()
                let follow_button = $('#follow')
                let unfollow_button = $('#unfollow')

                unfollow_button.trigger('click');
                assert.equal(follow_button.is(":visible"), true);
            })

            test('Unfollow button not visible after clicking unfollow', assert => {
                window.Network.initialize()
                let unfollow_button = $('#unfollow')
                unfollow_button.show()

                unfollow_button.trigger('click');
                assert.equal(unfollow_button.is(":visible"), false);
            })

            test('user_follows_profile true after clicking follow button', assert => {
                let user_follows_profile = $('#user_follows_profile')
                user_follows_profile.val('false')
                window.Network.initialize()

                $('#follow').trigger('click')
                assert.equal(user_follows_profile.val(), 'true')
            })

            test('user_follows_profile false after clicking unfollow button', assert => {
                let user_follows_profile = $('#user_follows_profile')
                user_follows_profile.val('true')
                window.Network.initialize()

                $('#unfollow').trigger('click')
                assert.equal(user_follows_profile.val(), 'false')
            })

            test('Unfollow button visible when user_follows_profile true', assert => {
                let user_follows_profile = $('#user_follows_profile')
                user_follows_profile.val('true')
                window.Network.initialize()
                assert.equal($('#unfollow').is(":visible"), true);
            })

            test('Unfollow button not visible when user_follows_profile false', assert => {
                let user_follows_profile = $('#user_follows_profile')
                user_follows_profile.val('false')
                window.Network.initialize()
                assert.equal($('#unfollow').is(":visible"), false);
            })

            test('Follow button not visible when user_follows_profile true', assert => {
                let user_follows_profile = $('#user_follows_profile')
                user_follows_profile.val('true')
                window.Network.initialize()
                assert.equal($('#follow').is(":visible"), false);
            })

            test('Follow button visible when user_follows_profile true', assert => {
                let user_follows_profile = $('#user_follows_profile')
                user_follows_profile.val('false')
                window.Network.initialize()
                assert.equal($('#follow').is(":visible"), true);
            })


        });


    </script>

</body>
</html>`